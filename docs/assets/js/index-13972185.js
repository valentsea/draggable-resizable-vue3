import{d as Je,u as D,r as g,e as Ke,f as b,i as we,g as Qe,h as F,o as q,c as J,j as Ze,F as _e,k as ea,n as K,l as oe,m as Se,p as Q,q as Re,s as Me}from"./index-48032f8e.js";function ze(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Function]"}function V(a,n,t,x=1){const[A,X]=typeof x=="number"?[x,x]:x,z=Math.round(n/A/a[0])*a[0],f=Math.round(t/X/a[1])*a[1];return[z,f]}function ue(a,n,t){return a-n-t}function ne(a,n,t){return a-n-t}function P(a,n,t){return n!==null&&a<n?n:t!==null&&t<a?t:a}function Be(a,n,t){let x=a;const A=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(X=>ze(x[X]));if(!ze(x[A]))return!1;do{if(x[A](n))return!0;if(x===t)return!1;x=x.parentNode}while(x);return!1}function aa(a){const n=window.getComputedStyle(a);return[parseFloat(n.getPropertyValue("width"),10),parseFloat(n.getPropertyValue("height"),10)]}function E(a,n,t){!a||(a.attachEvent?a.attachEvent("on"+n,t):a.addEventListener?a.addEventListener(n,t,!0):a["on"+n]=t)}function Ne(a,n,t){!a||(a.detachEvent?a.detachEvent("on"+n,t):a.removeEventListener?a.removeEventListener(n,t,!0):a["on"+n]=null)}const ta=["onMousedown","onTouchstart"],Pe={__name:"DraggableResizableVue3",props:{draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:[String,Number],default:"auto",validator:a=>typeof a=="string"?a==="auto":a>=0},w:{type:[Number,String],validator:a=>typeof a=="number"?a>0:a==="auto"},h:{type:[Number,String],validator:a=>typeof a=="number"?a>0:a==="auto"},minWidth:{type:Number,default:0,validator:a=>a>=0},minHeight:{type:Number,default:0,validator:a=>a>=0},maxWidth:{type:Number,default:null,validator:a=>a>=0},maxHeight:{type:Number,default:null,validator:a=>a>=0},active:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},activeOnHover:{type:Boolean,default:!1},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},lockAspectRatio:{type:Boolean,default:!1},handlesType:{type:String,default:"handles",validator:a=>["handles","borders","custom"].includes(a)},handles:{type:Array,default:()=>["tl","tm","tr","mr","br","bm","bl","ml"],validator:a=>{const n=new Set(["tl","tm","tr","mr","br","bm","bl","ml"]);return new Set(a.filter(t=>n.has(t))).size===a.length}},handlesSize:{type:Number,default:10},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:a=>["x","y","both"].includes(a)},grid:{type:Array,validator:a=>Array.isArray(a)&&typeof a[0]=="number"&&typeof a[1]=="number"},showGrid:{type:[Boolean,String],default:!1,validator:a=>[!0,!1,"x","y","both"].includes(a)},gridColor:{type:String,default:"rgba(0, 0, 0, 0.1)"},parent:{type:[Boolean,String],default:!1},scale:{type:[Number,Array],default:1,validator:a=>typeof a=="number"?a>0:a.length===2&&a[0]>0&&a[1]>0},className:{type:String,default:"drv"},classNameDraggable:{type:String,default:"drv-draggable"},classNameResizable:{type:String,default:"drv-resizable"},classNameDragging:{type:String,default:"drv-dragging"},classNameResizing:{type:String,default:"drv-resizing"},classNameActive:{type:String,default:"drv-active"},classNameHandle:{type:String,default:"drv-handle"},onDragStart:{type:Function,default:()=>!0},onDrag:{type:Function,default:()=>!0},onResizeStart:{type:Function,default:()=>!0},onResize:{type:Function,default:()=>!0}},emits:["update:x","update:y","update:w","update:h","update:active","resizing","resizestop","dragging","dragstop","activated","deactivated"],setup(a,{emit:n}){const t=a;Je(e=>({"5bb0fb4e":D(Te),"5def792c":D(Le)}));const x={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},A={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},X={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let z=x.mouse;const f=g(null),U=g(null),k=g({h:"auto",w:"auto",active:!1,x:0,y:0}),re=Ke(),p=b({get(){return t.w||k.value.w},set(e){n("update:w",e),k.value.w=e}}),h=b({get(){return t.h||k.value.h},set(e){n("update:h",e),k.value.h=e}}),o=b({get(){return t.x||k.value.x},set(e){n("update:x",e),k.value.x=e}}),r=b({get(){return t.y||k.value.y},set(e){n("update:y",e),k.value.y=e}}),i=g(null),c=g(null),H=b({get(){return t.active||k.value.active},set(e){n("update:active",e),k.value.active=e}}),Te=b(()=>t.handlesSize+"px"),Le=b(()=>t.handlesSize/2+"px"),Z=g(!1),_=g(!1),y=g(null),B=g(null),N=g(null),R=g(null),C=g(!1),T=g(!1),ee=g(!1),se=g(!1),ke=g(t.z),d=g(null),s=g(null),De=b(()=>({transform:`translate(${o.value}px, ${r.value}px)`,width:Ae.value,height:$e.value,zIndex:ke.value,...T.value&&t.disableUserSelect?A:X})),ve=we("drvContainerClass"),L=b(()=>ve.value?"."+ve.value:t.parent),ie=we("drvContainerGrid"),m=b(()=>ie.value?t.grid?t.grid:ie.value:t.grid||[1,1]),He=b(()=>{const e={x:`linear-gradient(-90deg, ${m.value.valueColor} 1px, transparent 1px) 0px 0px / ${m.value[0]}px ${m.value[0]}px`,y:`linear-gradient(0deg, ${m.value.valueColor} 1px, transparent 1px) 0px 0px / ${m.value[1]}px ${m.value[1]}px`};return t.showGrid==="x"||t.showGrid==="y"?e[t.showGrid]:t.showGrid?`${e.x}, ${e.y}`:null}),Ce=b(()=>t.resizable?t.handles:[]),Ae=b(()=>p.value==="auto"&&!Z.value?"auto":p.value+"px"),$e=b(()=>h.value==="auto"&&!_.value?"auto":h.value+"px"),Y=g(t.minWidth),G=g(t.minHeight),w=g(t.maxWidth),S=g(t.maxHeight),ce=b(()=>Boolean(R.value)&&(R.value.includes("l")||R.value.includes("r"))),de=b(()=>Boolean(R.value)&&(R.value.includes("t")||R.value.includes("b"))),ae=()=>{d.value={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},s.value={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},Xe=()=>{if(L.value){const[e,u]=me();B.value=e,N.value=u,i.value=B.value-p.value-o.value,c.value=N.value-h.value-r.value}},me=()=>{if(L.value){const e=typeof L.value=="string"?f.value.closest(L.value):f.value.parentNode;U.value=e;const u=window.getComputedStyle(e,null);return[parseInt(u.getPropertyValue("width"),10),parseInt(u.getPropertyValue("height"),10)]}return[null,null]},fe=()=>{if(L.value&&t.showGrid){if(!U.value){const e=typeof e.value=="string"?f.value.closest(e.value):f.value.parentNode;U.value=e}U.value.style.background=He.value}},Ye=e=>{z=x.touch,ge(e)},Ge=e=>{z=x.mouse,ge(e)},ge=e=>{if(e instanceof MouseEvent&&e.which!==1)return;const u=e.target||e.srcElement;if(f.value.contains(u)){if(t.onDragStart(e)===!1)return;if(t.dragHandle&&!Be(u,t.dragHandle,f.value)||t.dragCancel&&Be(u,t.dragCancel,f.value)){T.value=!1;return}H.value||(H.value=!0,n("activated")),t.draggable&&(ee.value=!0),d.value.mouseX=e.touches?e.touches[0].pageX:e.pageX,d.value.mouseY=e.touches?e.touches[0].pageY:e.pageY,d.value.left=o.value,d.value.right=i.value,d.value.top=r.value,d.value.bottom=c.value,L.value&&(s.value=te()),E(document.documentElement,z.move,We),E(document.documentElement,z.stop,xe)}},te=()=>({minLeft:o.value%m.value[0],maxLeft:Math.floor((B.value-p.value-o.value)/m.value[0])*m.value[0]+o.value,minRight:i.value%m.value[0],maxRight:Math.floor((B.value-p.value-i.value)/m.value[0])*m.value[0]+i.value,minTop:r.value%m.value[1],maxTop:Math.floor((N.value-h.value-r.value)/m.value[1])*m.value[1]+r.value,minBottom:c.value%m.value[1],maxBottom:Math.floor((N.value-h.value-c.value)/m.value[1])*m.value[1]+c.value}),pe=e=>{const u=e.target||e.srcElement,l=new RegExp(t.className+"-([trmbl]{2})","");(!f.value||!f.value.contains(u)&&!l.test(u.className))&&(H.value&&!t.preventDeactivation&&(H.value=!1,n("deactivated")),Ne(document.documentElement,z.move,O)),ae()},Ee=(e,u)=>{z=x.touch,he(e,u)},he=(e,u)=>{u instanceof MouseEvent&&u.which!==1||t.onResizeStart(e,u)!==!1&&(u.stopPropagation&&u.stopPropagation(),t.lockAspectRatio&&!e.includes("m")?R.value="m"+e.substring(1):R.value=e,se.value=!0,d.value.mouseX=u.touches?u.touches[0].pageX:u.pageX,d.value.mouseY=u.touches?u.touches[0].pageY:u.pageY,d.value.left=o.value,d.value.right=i.value,d.value.top=r.value,d.value.bottom=c.value,s.value=le(),E(document.documentElement,z.move,O),E(document.documentElement,z.stop,xe))},le=()=>{const[e,u]=m.value;t.lockAspectRatio&&(Y.value/G.value>y.value?G.value=Y.value/y.value:Y.value=y.value*G.value,w.value&&S.value?(w.value=Math.min(w.value,y.value*S.value),S.value=Math.min(S.value,w.value/y.value)):w.value?S.value=w.value/y.value:S.value&&(w.value=y.value*S.value)),w.value=w.value-w.value%e,S.value=S.value-S.value%u;const l={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return L.value?(l.minLeft=o.value%e,l.maxLeft=o.value+Math.floor((p.value-Y.value)/e)*e,l.minTop=r.value%u,l.maxTop=r.value+Math.floor((h.value-G.value)/u)*u,l.minRight=i.value%e,l.maxRight=i.value+Math.floor((p.value-Y.value)/e)*e,l.minBottom=c.value%u,l.maxBottom=c.value+Math.floor((h.value-G.value)/u)*u,w.value&&(l.minLeft=Math.max(l.minLeft,B.value-i.value-w.value),l.minRight=Math.max(l.minRight,B.value-o.value-w.value)),S.value&&(l.minTop=Math.max(l.minTop,N.value-c.value-S.value),l.minBottom=Math.max(l.minBottom,N.value-r.value-S.value)),t.lockAspectRatio&&(l.minLeft=Math.max(l.minLeft,o.value-r.value*y.value),l.minTop=Math.max(l.minTop,r.value-o.value/y.value),l.minRight=Math.max(l.minRight,i.value-c.value*y.value),l.minBottom=Math.max(l.minBottom,c.value-i.value/y.value))):(l.minLeft=null,l.maxLeft=o.value+Math.floor((p.value-Y.value)/e)*e,l.minTop=null,l.maxTop=r.value+Math.floor((h.value-G.value)/u)*u,l.minRight=null,l.maxRight=i.value+Math.floor((p.value-Y.value)/e)*e,l.minBottom=null,l.maxBottom=c.value+Math.floor((h.value-G.value)/u)*u,w.value&&(l.minLeft=-(i.value+w.value),l.minRight=-(o.value+w.value)),S.value&&(l.minTop=-(c.value+S.value),l.minBottom=-(r.value+S.value)),t.lockAspectRatio&&w.value&&S.value&&(l.minLeft=Math.min(l.minLeft,-(i.value+w.value)),l.minTop=Math.min(l.minTop,-(S.value+c.value)),l.minRight=Math.min(l.minRight,-o.value-w.value),l.minBottom=Math.min(l.minBottom,-r.value-S.value))),l},We=e=>{C.value?O(e):ee.value&&Fe(e)},Fe=e=>{const u=t.axis&&t.axis!=="y"?d.value.mouseX-(e.touches?e.touches[0].pageX:e.pageX):0,l=t.axis&&t.axis!=="x"?d.value.mouseY-(e.touches?e.touches[0].pageY:e.pageY):0,[v,M]=V(m.value,u,l,t.scale),$=P(d.value.left-v,s.value.minLeft,s.value.maxLeft),W=P(d.value.top-M,s.value.minTop,s.value.maxTop);if(t.onDrag(o,r)===!1)return;const j=P(d.value.right+v,s.value.minRight,s.value.maxRight),I=P(d.value.bottom+M,s.value.minBottom,s.value.maxBottom);o.value=$,r.value=W,i.value=j,c.value=I,n("dragging",o.value,r.value),T.value=!0},Ve=e=>{const[u,l]=V(m.value,e,r.value,1),v=P(u,s.value.minLeft,s.value.maxLeft);o.value=v,i.value=B.value-p.value-v},Ue=e=>{const[u,l]=V(m.value,o.value,e,1),v=P(l,s.value.minTop,s.value.maxTop);r.value=v,c.value=N.value-h.value-v},O=e=>{let u=o.value,l=r.value,v=i.value,M=c.value;const $=d.value.mouseX-(e.touches?e.touches[0].pageX:e.pageX),W=d.value.mouseY-(e.touches?e.touches[0].pageY:e.pageY);!Z.value&&$&&(Z.value=!0),!_.value&&W&&(_.value=!0);const[j,I]=V(m.value,$,W,t.scale);R.value.includes("b")?(M=P(d.value.bottom+I,s.value.minBottom,s.value.maxBottom),t.lockAspectRatio&&de&&(v=i.value-(c.value-M)*y.value)):R.value.includes("t")&&(l=P(d.value.top-I,s.value.minTop,s.value.maxTop),t.lockAspectRatio&&de&&(u=o.value-(r.value-l)*y.value)),R.value.includes("r")?(v=P(d.value.right+j,s.value.minRight,s.value.maxRight),t.lockAspectRatio&&ce&&(M=c.value-(i.value-v)/y.value)):R.value.includes("l")&&(u=P(d.value.left-j,s.value.minLeft,s.value.maxLeft),t.lockAspectRatio&&ce&&(l=r.value-(o.value-u)/y.value));const ye=ue(B.value,u,v),be=ne(N.value,l,M);t.onResize(R.value,u,l,ye,be)!==!1&&(o.value=u,r.value=l,i.value=v,c.value=M,p.value=ye,h.value=be,n("resizing",o.value,r.value,p.value,h.value),C.value=!0)},Oe=e=>{const[u]=V(m.value,e,0,1);let l=P(B.value-u-o.value,s.value.minRight,s.value.maxRight),v=c.value;t.lockAspectRatio&&(v=c.value-(i.value-l)/y.value);const M=ue(B.value,o.value,l),$=ne(N.value,r.value,v);i.value=l,c.value=v,p.value=M,h.value=$},je=e=>{const[u,l]=V(m.value,0,e,1);let v=P(N.value-l-r.value,s.value.minBottom,s.value.maxBottom),M=i.value;t.lockAspectRatio&&(M=i.value-(c.value-v)*y.value);const $=ue(B.value,o.value,M),W=ne(N.value,r.value,v);i.value=M,c.value=v,p.value=$,h.value=W},xe=e=>{R.value=null,ae(),ee.value=!1,se.value=!1,C.value&&(C.value=!1,n("resizestop",o.value,r.value,p.value,h.value)),T.value&&(T.value=!1,n("dragstop",o.value,r.value)),Ne(document.documentElement,z.move,O)},Ie=()=>{t.activeOnHover&&(H.value=!0)},qe=()=>{t.activeOnHover&&!T.value&&(H.value=!1)};return Qe(()=>{ae(),t.enableNativeDrag||(f.value.ondragstart=()=>!1);const[e,u]=me();B.value=e,N.value=u;const[l,v]=aa(f.value);y.value=(p.value!=="auto"?p.value:l)/(h.value!=="auto"?h.value:v),p.value=p.value!=="auto"?p.value:l,h.value=h.value!=="auto"?h.value:v,i.value=B.value-p.value-o.value,c.value=N.value-h.value-r.value,H.value&&n("activated"),t.showGrid&&fe(),E(document.documentElement,"mousedown",pe),E(document.documentElement,"touchend touchcancel",pe),E(window,"resize",Xe)}),F(()=>t.x,e=>{C.value||T.value||(L.value&&(s.value=te()),Ve(e))}),F(()=>t.y,e=>{C.value||T.value||(L.value&&(s.value=te()),Ue(e))}),F(()=>t.lockAspectRatio,e=>{e?y.value=p.value/h.value:y.value=void 0}),F(()=>t.w,e=>{C.value||T.value||(L.value&&(s.value=le()),Oe(e))}),F(()=>t.h,e=>{C.value||T.value||(L.value&&(s.value=le()),je(e))}),F(()=>t.showGrid,()=>{fe()}),(e,u)=>(q(),J("div",{ref_key:"el",ref:f,style:oe(D(De)),class:K([{[a.classNameActive]:D(H),[a.classNameDragging]:T.value,[a.classNameResizing]:C.value,[a.classNameDraggable]:a.draggable,[a.classNameResizable]:a.resizable},a.className]),onMousedown:Ge,onTouchstart:Ye,onMouseover:Ie,onMouseleave:qe},[Ze("div",{class:K("drv-"+a.handlesType)},[(q(!0),J(_e,null,ea(D(Ce),l=>(q(),J("div",{key:l,class:K([a.classNameHandle,a.classNameHandle+"-"+l,a.classNameHandle!=="drv-handle"?"drv-handle":"",a.classNameHandle!=="drv-handle"?"drv-handle-"+l:""]),style:oe({display:D(H)?"block":"none"}),onMousedown:Se(v=>he(l,v),["stop","prevent"]),onTouchstart:Se(v=>Ee(l,v),["stop","prevent"])},[D(re)["handle-"+l]?Q(e.$slots,"handle-"+l,{key:0}):Re("",!0),D(re)["handle-"+l]?Re("",!0):Q(e.$slots,"handle",{key:1})],46,ta))),128))],2),Q(e.$slots,"default")],38))}},la={__name:"DraggableResizableContainer",props:{grid:{type:Array,default:()=>[1,1],validator:a=>Array.isArray(a)&&typeof a[0]=="number"&&typeof a[1]=="number"},showGrid:{type:[Boolean,String],default:!1,validator:a=>[!0,!1,"x","y","both"].includes(a)},gridColor:{type:String,default:"rgba(0, 0, 0, 0.1)"},className:{type:String,default:"drv-container"}},setup(a){const n=a,t=b(()=>n.grid),x=b(()=>n.className);Me("drvContainerClass",x),Me("drvContainerGrid",t);const A=g(null),X=b(()=>{const f={x:`linear-gradient(-90deg, ${n.gridColor} 1px, transparent 1px) 0px 0px / ${n.grid[0]}px ${n.grid[0]}px`,y:`linear-gradient(0deg, ${n.gridColor} 1px, transparent 1px) 0px 0px / ${n.grid[1]}px ${n.grid[1]}px`};return n.showGrid==="x"||n.showGrid==="y"?f[n.showGrid]:n.showGrid?`${f.x}, ${f.y}`:null}),z=b(()=>{const f={position:"relative"};return n.showGrid&&(f.background=X.value),f});return(f,U)=>(q(),J("div",{ref_key:"el",ref:A,style:oe(D(z)),class:K([D(x)])},[Q(f.$slots,"default")],6))}};Pe.install=a=>(a.component("DraggableResizableContainer",Pe),a.component("DraggableResizableContainer",la),a);export{Pe as _,la as a};
